<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="user-scalable=no">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="normalize.css">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<div id="editor" contenteditable="true">
</div>
<script type="text/javascript" src="rich_editor.js"></script>
<script type="text/javascript" src="jquery.min.js"></script>
</body>
<script type="text/javascript">
	var $textElem =  $("#editor");
	$textElem.append($('<p style="line-height: 1.5;word-break: break-all;"><br></p>'));
	$textElem.on('keydown', function (e) {
	if (e.keyCode !== 8) {
	    return;
	}
	var txtHtml = $textElem.html().toLowerCase().trim();
	if (txtHtml === '<p style="line-height: 1.5;word-break: break-all;"><br></p>') {
	    // 最后剩下一个空行，就不再删除了
	    e.preventDefault();
	    return;
	}
	});

	$textElem.on('keyup', function (e) {
	if (e.keyCode !== 8) {
	    return;
	}
	var $p = void 0;
	var txtHtml = $textElem.html().toLowerCase().trim();

	// firefox 时用 txtHtml === '<br>' 判断，其他用 !txtHtml 判断
	if (!txtHtml || txtHtml === '<br>') {
	    // 内容空了
	    $p = $('<p style="line-height: 1.5;word-break: break-all;"><br/></p>');
	    $textElem.html(''); // 一定要先清空，否则在 firefox 下有问题
	    $textElem.append($p);
	    editor.selection.createRangeByElem($p, false, true);
	    editor.selection.restoreSelection();
	}
	});
$("#editor p, #editor h1, #editor h2, #editor h3, #editor h4, #editor h5, #editor table, #editor pre,#editor blockquote").css({
	'line-height': '1.5',
	'word-break': 'break-all'
});
$("#editor img").css({
	width: '100%',
	height: '100%'
});
</script>
</html>
